[{%- assign position = 0 -%}{%- assign linksize = linklist.links | size -%}{% for link in linklist.links %}{%- assign subject_id = link.url  -%}{%- assign subject_params = null  -%}{%- assign childrensize = link.links | size  -%}{% if link.type == "product_link" %}{%- assign subject_id = subject_id | replace: "/products/", "" -%}{% elsif link.type == "page_link" %}{%- assign subject_id = subject_id | replace: "/pages/", "" -%}{% elsif link.type == "blog_link" %}{%- assign subject_id = subject_id | replace: "/blogs/", "" -%}{% elsif link.type == "collection_link" %}{%- assign subject_id = subject_id | replace: "/collections/", "" -%}{%- assign params = subject_id | split: "/" -%}{% if params.size > 1 %}{%- assign subject_id = params.first -%}{%- assign subject_params = params.last | replace: "+", ", " -%}{% endif %}{% endif %}{%- assign position = position | plus: 1 -%}{"id": "{{ position }}","title": "{{ link.title | replace: '"', '\"' }}","subject": "{{ subject_id }}","subject_id": "{{ link.object.id }}","link_list_id": "{{ count }}","position": {{ position }},"subject_params": "{{ subject_params }}","link_type": "{{ link.type | replace: "_link", "" }}","levels": {{ link.levels }},"links": {% if childrensize > 0 %} {% include "motifmate-links", linklist: link, count: count %} {% else %} null {% endif %}}{% if forloop.last != true %},{% endif %}{% endfor %}]